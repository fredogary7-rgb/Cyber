<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Parrainage - Mon √©quipe</title>
<style>
  :root{
    --bg:#f6f7f9; --card:#fff; --accent:#000; --muted:#777;
    --success:#27ae60;
  }
  body{font-family:Inter, Poppins, Arial, sans-serif; margin:0; background:var(--bg); color:#111;}
  .wrap{max-width:760px; margin:0 auto; padding:18px;}
  .header{display:flex; align-items:center; gap:12px; background:var(--card); padding:16px; border-radius:10px;}
  .avatar{width:56px;height:56px;border-radius:10px;object-fit:cover;background:#eee;}
  .user-meta .code{font-size:18px;font-weight:700;}
  .user-meta .sub{color:var(--muted); font-size:13px;}
  .card{background:var(--card); margin-top:14px; padding:14px; border-radius:10px; box-shadow:0 6px 18px rgba(20,20,20,0.03);}
  .ref-row{display:flex; gap:10px; align-items:center; flex-wrap:wrap;}
  .ref-box{flex:1; background:#fafafa; border:1px solid #eee; padding:10px 12px; border-radius:8px; font-weight:600;}
  .btn{padding:10px 14px; border-radius:8px; border:none; cursor:pointer; font-weight:600;}
  .btn-copy{background:#111;color:#fff;}
  .btn-link{background:#fff;color:#111;border:1px solid #ddd;}
  .stats-grid{display:grid; grid-template-columns: repeat(2,1fr); gap:12px; margin-top:12px;}
  .stat{background:#fff;padding:12px;border-radius:8px;text-align:center;border:1px solid #f0f0f0;}
  .stat .num{font-weight:700;font-size:18px;}
  .stat .label{color:var(--muted); font-size:13px;margin-top:6px;}
  .big-stat{grid-column: span 2; display:flex; justify-content:space-between; align-items:center; gap:10px;}
  .small{font-size:13px;color:var(--muted); margin-top:8px;}
  .copy-note{font-size:12px;color:#3d3d3d; margin-top:8px;}
  @media (max-width:520px){
    .stats-grid{grid-template-columns: repeat(1,1fr);}
    .big-stat{flex-direction:column; align-items:flex-start;}
  }

        /* --- NAVIGATION BAS --- */ .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background-color: #fff;
            border-top: 1px solid #ddd;
            display: flex;
            justify-content: space-around;
            align-items: center;
            padding: 8px 0;
            z-index: 10;
        }

        .bottom-nav a {
            text-decoration: none;
            color: #555;
            font-size: 12px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .bottom-nav a i {
            font-size: 20px;
            margin-bottom: 2px;
            color: #000;
        }

        /* --- RESPONSIVE --- */
        @media (max-width: 480px) {
            .dashboard-header img {
                height: 170px;
            }
        }

</style>
</head>
<body>
  <div class="wrap">
    <!-- header -->
    <div class="header">
      <img src="{{ url_for('static', filename='images/cyber1.jpg') }}" class="avatar" alt="avatar">
      <div class="user-meta">
        <div class="code">{{ referral_code }}</div>
        <div class="sub">Votre code de parrainage</div>
      </div>
    </div>

    <!-- referral card -->
    <div class="card">
      <div style="display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:wrap;">
        <div style="flex:1;min-width:220px;">
          <div style="font-size:13px;color:var(--muted);margin-bottom:8px;">Partagez votre code ou lien</div>

          <div class="ref-row">
            <div class="ref-box" id="refBox">{{ referral_code }}</div>
            <button class="btn btn-copy" onclick="copyText('#refBox')">Copier</button>
          </div>

          <div style="height:10px;"></div>

          <div class="ref-row">
            <div class="ref-box" id="refLinkBox" style="font-weight:500; font-size:13px; overflow-wrap:anywhere;">
              {{ referral_link }}
            </div>
            <button class="btn btn-link" onclick="copyText('#refLinkBox')">Copier le lien</button>
          </div>

          <div class="copy-note">Astuce : partagez le lien dans vos r√©seaux pour inviter facilement des nouveaux membres.</div>
        </div>

        <div style="min-width:220px;">
          <div style="font-size:13px;color:var(--muted); margin-bottom:8px;">Raccourci</div>
          <a href="https://t.me/share/url?url={{ referral_link }}&text=Rejoins-moi" target="_blank" style="text-decoration:none;">
            <button class="btn btn-copy" style="width:100%; background: #0088cc; margin-top:0;">Partager sur Telegram</button>
          </a>
        </div>
      </div>
    </div>

    <!-- stats -->
    <div class="card" style="margin-top:12px;">
      <div style="font-weight:700; margin-bottom:8px;">Statistiques de parrainage</div>
      <div class="stats-grid">
        <div class="stat">
          <div class="num">{{ stats.level1 }}</div>
          <div class="label">Filleuls - Niveau 1</div>
        </div>

        <div class="stat">
          <div class="num">{{ stats.level2 }}</div>
          <div class="label">Filleuls - Niveau 2</div>
        </div>

        <div class="stat">
          <div class="num">{{ stats.level3 }}</div>
          <div class="label">Filleuls - Niveau 3</div>
        </div>

        <div class="stat">
          <div class="num">{{ "{:,.0f}".format(stats.commissions_total)|replace(",", " ") }} XOF</div>
          <div class="label">Commissions re√ßues</div>
        </div>

        <div class="big-stat" style="grid-column:span 2;">
          <div>
            <div style="font-size:13px;color:var(--muted)">Total d√©p√¥ts √©quipe</div>
            <div style="font-weight:700; font-size:18px;">{{ "{:,.0f}".format(stats.team_deposits)|replace(",", " ") }} XOF</div>
          </div>
          <div style="text-align:right;">
            <div style="font-size:13px;color:var(--muted)">Derni√®re activit√©</div>
            <div style="font-weight:600;">{{ stats.last_activity or 'Aucune' }}</div>
          </div>
        </div>
      </div>

      <div class="small">Remarque : les utilisateurs ont toujours le droit de reclamer tous leurs commissions au cas ou il manques</div>
    </div>
  </div>
    <!-- NAVIGATION DU BAS -->
    <div class="bottom-nav">
        <a href="/dashboard"><i class="fa-solid fa-house"></i>Maison</a>
        <a href="/investissements"><i class="fa-solid fa-box"></i>Produits</a>
        <a href="/team"><i class="fa-solid fa-users"></i>√âquipe</a>
        <a href="/profile"><i class="fa-solid fa-user"></i>Moi</a>
    </div>

<script>
  function copyText(selector){
    const el = document.querySelector(selector);
    if(!el) return;

    // üî• plus fiable que innerText (probl√®me sur Android)
    const text = el.textContent.trim();

    // üî• clipboard API standard (plus compatible si on enl√®ve le ?.)
    navigator.clipboard.writeText(text).then(() => {
        alert('Copi√© dans le presse-papiers ‚úîÔ∏è');
    }).catch(() => {
        // --- Fallback (fonctionne sur TOUS les appareils) ---
        const ta = document.createElement('textarea');
        ta.value = text;
        document.body.appendChild(ta);
        ta.select();
        try { 
            document.execCommand('copy'); 
            alert('Copi√© ‚úîÔ∏è'); 
        } catch(e) { 
            alert('Impossible de copier ‚ùå'); 
        }
        ta.remove();
    });
  }
</script>
</body>
</html>
